# Envoy Release v1.36.0

[release note](https://www.envoyproxy.io/docs/envoy/latest/version_history/v1.36/v1.36.0)

## behavior_changes

**category**   : behavior_changes  
**area**       : http_11_proxy  
**summary**    : transport_socket(http_11_proxy): add Host field to CONNECT and prefer hostname to make it RFC 9110 compliant (#41088)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [c3671dcd1731b74a5fe11d6e53c35c1a53070933](https://github.com/envoyproxy/envoy/commit/c3671dcd1731b74a5fe11d6e53c35c1a53070933) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [41088](https://github.com/envoyproxy/envoy/pull/41088) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
HTTP/1.1 proxy transport socket now generates RFC 9110 compliant ``CONNECT`` requests that include a ``Host`` header by default. When proxy address is configured via endpoint metadata, the transport socket now prefers hostname:port format over IP:port when hostname is available. The legacy behavior (``CONNECT`` without ``Host`` header) can be restored by setting the runtime flag ``envoy.reloadable_features.http_11_proxy_connect_legacy_format`` to ``true``.   
 
---

**category**   : behavior_changes  
**area**       : response_decoder  
**summary**    : response decoder: Roll forward ResponseDecoderHandle (#41193)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [c6fe45e40f602e5288b6d4a51e2904b0c937583a](https://github.com/envoyproxy/envoy/commit/c6fe45e40f602e5288b6d4a51e2904b0c937583a) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [41193](https://github.com/envoyproxy/envoy/pull/41193) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
Updated ``EnvoyQuicClientStream`` and ``ResponseDecoderWrapper`` to use a handle to access the response decoder to prevent use-after-free errors by ensuring the decoder instance is still live before calling its methods. This change is guarded by the runtime flag ``envoy.reloadable_features.use_response_decoder_handle``.   
 
---

**category**   : behavior_changes  
**area**       : http  
**summary**    : http: refresh the trace decision/decorator by route refresh (#40336)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [6944017f9fb497b81e5f37cd316e406c388a3e4e](https://github.com/envoyproxy/envoy/commit/6944017f9fb497b81e5f37cd316e406c388a3e4e) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40336](https://github.com/envoyproxy/envoy/pull/40336) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
A route refresh will now result in a tracing refresh. The trace sampling decision and decoration of the new route will be applied to the active span. This change can be reverted by setting the runtime guard ``envoy.reloadable_features.trace_refresh_after_route_refresh`` to ``false``. Note, if [pack_trace_reason](/docs/envoy/latest/api-v3/extensions/request_id/uuid/v3/uuid.proto#envoy-v3-api-field-extensions-request-id-uuid-v3-uuidrequestidconfig-pack-trace-reason) is set to ``true`` (it is ``true`` by default), a request marked as traced cannot be unmarked as traced after the tracing refresh.   
 
---

**category**   : behavior_changes  
**area**       : http2  
**summary**    : http2: change the default value of max concurrent streams to 1024 (#40716)  
**commit**     : [9ad6cf10aac7984464712b01436c3a19dd32f064](https://github.com/envoyproxy/envoy/commit/9ad6cf10aac7984464712b01436c3a19dd32f064)  
**pr**         : [40716](https://github.com/envoyproxy/envoy/pull/40716)  
**description**:  
The default value for the [maximum]() has been changed from 2147483647 to 1024. The default value for the [initial]() has been changed from 256MiB to 16MiB. The default value for the [initial]() has been changed from 256MiB to 24MiB. This change could be reverted temporarily by setting the runtime guard ``envoy.reloadable_features.safe_http2_options`` to ``false``.   
 
---

**category**   : behavior_changes  
**area**       : ext_proc  
**summary**    : Revert "Ext_proc: do not support fail_open+FULL_DUPLEX_STREAMED configuraton combination (#39740)" (#40503)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [1188a69c33b96fe817407225e4d231b8073cc7dc](https://github.com/envoyproxy/envoy/commit/1188a69c33b96fe817407225e4d231b8073cc7dc) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [39740](https://github.com/envoyproxy/envoy/pull/39740) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Reverted `#39740 <https://github.com/envoyproxy/envoy/pull/39740>`_ to re-enable ``fail_open`` + ``FULL_DUPLEX_STREAMED`` configuration combination.   
 
---

**category**   : behavior_changes  
**area**       : load balancing  
**summary**    : Move Locality WRR schedulers out of HostSetImpl (#40682)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [f788171f32b4d269b845a6254aae5662199d5f57](https://github.com/envoyproxy/envoy/commit/f788171f32b4d269b845a6254aae5662199d5f57) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40682](https://github.com/envoyproxy/envoy/pull/40682) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Moved locality WRR structures out of ``HostSetImpl`` and into a separate class. Locality WRR schedulers are now by default owned and constructed by the underlying Zone Aware LB, instead of owned and constructed by the Host Set. There should be no visible behavior change for existing users of Zone Aware LBs.   
 
---

## minor_behavior_changes

**category**   : minor_behavior_changes  
**area**       : tap  
**summary**    : Transport Tap/Buffered trace - Submit captured transport streamed trace data as smoothly as possible with the configured chunk size (#40471)  
**commit**     : [1eeffef30d0f22b48f509231f68d189c1ff03af4](https://github.com/envoyproxy/envoy/commit/1eeffef30d0f22b48f509231f68d189c1ff03af4)  
**pr**         : [40471](https://github.com/envoyproxy/envoy/pull/40471)  
**description**:  
Previously, streamed trace buffered data was only flushed when it reached the configured size. If the threshold was never met, the data remained buffered until the connection was closed. With this change, buffered data will be flushed proactively. Specifically, if the buffer does not reach the configured size but has been held for more than 15 seconds, it will be sent immediately.   
 
---

**category**   : minor_behavior_changes  
**area**       : websocket  
**summary**    : websocket: allow retry for 4xx and 5xx in the response (#40303)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [8f424102f7c2160ba8a69c1a23c4dc3d951b7cad](https://github.com/envoyproxy/envoy/commit/8f424102f7c2160ba8a69c1a23c4dc3d951b7cad) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40303](https://github.com/envoyproxy/envoy/pull/40303) [41491](https://github.com/envoyproxy/envoy/pull/41491) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Allow ``4xx`` and ``5xx`` to go through the filter chain for the WebSocket handshake response check. This behavior can be disabled by the runtime guard ``envoy.reloadable_features.websocket_allow_4xx_5xx_through_filter_chain``.   
 
---

**category**   : minor_behavior_changes  
**area**       : websocket  
**summary**    : websocket: support route timeout for HTTP upgrade (#41075)  
**summary**    : changelog: addressing some nits in the change logs before release  (#41497)  
**commit**     : [d4e053d499b6f96edb591476f34c0d8c2b29ba0f](https://github.com/envoyproxy/envoy/commit/d4e053d499b6f96edb591476f34c0d8c2b29ba0f) [6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9](https://github.com/envoyproxy/envoy/commit/6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9)  
**pr**         : [41075](https://github.com/envoyproxy/envoy/pull/41075) [41497](https://github.com/envoyproxy/envoy/pull/41497)  
**description**:  
Support route and per-try timeouts on WebSocket upgrade. This can be disabled by the runtime guard ``envoy.reloadable_features.websocket_enable_timeout_on_upgrade_response``.   
 
---

**category**   : minor_behavior_changes  
**area**       : testing  
**summary**    : Unify scattered header matchers into ContainsHeader (#40528)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [4276caf2210454eff74e3d494865b1cb881f8643](https://github.com/envoyproxy/envoy/commit/4276caf2210454eff74e3d494865b1cb881f8643) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40528](https://github.com/envoyproxy/envoy/pull/40528) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
In test code for external extensions, matchers ``Http::HeaderValueOf``, ``HasHeader``, and ``HeaderHasValueRef`` must be replaced with ``ContainsHeader``. Any uses of matcher ``HeaderHasValue(...)`` should be replaced with ``::testing::Pointee(ContainsHeader(...))``.   
 
---

**category**   : minor_behavior_changes  
**area**       : thrift  
**summary**    : http filter thrift_to_metadata allows field_selector to parse thrift paylaod (#41023)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [ef5577b5d76e37ef15821a659038fb40726a9fba](https://github.com/envoyproxy/envoy/commit/ef5577b5d76e37ef15821a659038fb40726a9fba) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [41023](https://github.com/envoyproxy/envoy/pull/41023) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
[field_selector](/docs/envoy/latest/api-v3/extensions/filters/http/thrift_to_metadata/v3/thrift_to_metadata.proto#envoy-v3-api-field-extensions-filters-http-thrift-to-metadata-v3-rule-field-selector) takes precedence over [field](/docs/envoy/latest/api-v3/extensions/filters/http/thrift_to_metadata/v3/thrift_to_metadata.proto#envoy-v3-api-field-extensions-filters-http-thrift-to-metadata-v3-rule-field) if both set. Not that [field_selector](/docs/envoy/latest/api-v3/extensions/filters/http/thrift_to_metadata/v3/thrift_to_metadata.proto#envoy-v3-api-field-extensions-filters-http-thrift-to-metadata-v3-rule-field-selector) was in WIP status.   
 
---

**category**   : minor_behavior_changes  
**area**       : generic_proxy  
**summary**    : generic proxy codec add buffer limit (#40560)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [c443c5317552120768d09b448f1e1d6d0f3e8b03](https://github.com/envoyproxy/envoy/commit/c443c5317552120768d09b448f1e1d6d0f3e8b03) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40560](https://github.com/envoyproxy/envoy/pull/40560) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Generic proxy codec adds the same buffer limit as the connection buffer limit. If the buffer limit is exceeded, the connection is disconnected. This behavior can be reverted by setting the runtime guard ``envoy.reloadable_features.generic_proxy_codec_buffer_limit`` to ``false``.   
 
---

**category**   : minor_behavior_changes  
**area**       : http3  
**summary**    : quic: turn off HTTP/3 happy eyeball (#40703)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [a008e6f663f822d8bba75d48944fbcc0c68169ee](https://github.com/envoyproxy/envoy/commit/a008e6f663f822d8bba75d48944fbcc0c68169ee) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40703](https://github.com/envoyproxy/envoy/pull/40703) [41161](https://github.com/envoyproxy/envoy/pull/41161) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Turned off HTTP/3 happy eyeballs in upstream via the runtime guard ``envoy.reloadable_features.http3_happy_eyeballs``. It was found to favor TCP over QUIC when UDP does not work on IPv6 but works on IPv4.   
 
---

**category**   : minor_behavior_changes  
**area**       : mobile  
**summary**    : mobile: decouple DNS refresh and explicit pool drain upon network change  (#40847)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [69a019355be432e3a82d1009eb3de74e237ee967](https://github.com/envoyproxy/envoy/commit/69a019355be432e3a82d1009eb3de74e237ee967) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40847](https://github.com/envoyproxy/envoy/pull/40847) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Explicitly drain connections upon network change events regardless of whether the DNS cache is refreshed or not. This behavior can be reverted by setting the runtime guard ``envoy.reloadable_features.decouple_explicit_drain_pools_and_dns_refresh`` to ``false``.   
 
---

**category**   : minor_behavior_changes  
**area**       : http  
**summary**    : http: adds BytesMeter members for decompressed header bytes (#40684)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [f2bfc97c8757f9f4dde973c76a2cb2c3dc312787](https://github.com/envoyproxy/envoy/commit/f2bfc97c8757f9f4dde973c76a2cb2c3dc312787) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40684](https://github.com/envoyproxy/envoy/pull/40684) [40993](https://github.com/envoyproxy/envoy/pull/40993) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Added accounting for decompressed HTTP header bytes sent and received. Existing stats only count wire-encoded header bytes. This can be accessed through the ``%UPSTREAM_DECOMPRESSED_HEADER_BYTES_RECEIVED%``, ``%DOWNSTREAM_DECOMPRESSED_HEADER_BYTES_RECEIVED%``, ``%UPSTREAM_DECOMPRESSED_HEADER_BYTES_SENT%``, and ``%DOWNSTREAM_DECOMPRESSED_HEADER_BYTES_SENT%`` access log command operators.   
 
---

**category**   : minor_behavior_changes  
**area**       : formatter  
**summary**    : formatter: removed legacy router formatter support (#41039)  
**summary**    : changelog: addressing some nits in the change logs before release  (#41497)  
**commit**     : [d3b102fa3351952c19705585b8fcefc8f57e11b3](https://github.com/envoyproxy/envoy/commit/d3b102fa3351952c19705585b8fcefc8f57e11b3) [6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9](https://github.com/envoyproxy/envoy/commit/6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9)  
**pr**         : [41039](https://github.com/envoyproxy/envoy/pull/41039) [41497](https://github.com/envoyproxy/envoy/pull/41497)  
**description**:  
Deprecated legacy header formatter support for ``%DYNAMIC_METADATA(["namespace", "key", ...])%``, ``%UPSTREAM_METADATA(["namespace", "key", ...])%`` and ``%PER_REQUEST_STATE(key)%``. Please use ``%DYNAMIC_METADATA(namespace:key:...])%``, ``%UPSTREAM_METADATA(namespace:key:...])%`` and ``%FILTER_STATE(key:PLAIN)%`` as alternatives. This change is guarded by the runtime flag ``envoy.reloadable_features.remove_legacy_route_formatter`` and default to ``false`` for now and will be flipped to ``true`` after two release periods.   
 
---

**category**   : minor_behavior_changes  
**area**       : oauth2  
**summary**    : chore: set response code details to oauth2 filter 401 local response (#40736)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [48ea1f1751e1cd887c35f9919a98ac0d88c784f7](https://github.com/envoyproxy/envoy/commit/48ea1f1751e1cd887c35f9919a98ac0d88c784f7) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40736](https://github.com/envoyproxy/envoy/pull/40736) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Added response code details to ``401`` local responses generated by the OAuth2 filter.   
 
---

**category**   : minor_behavior_changes  
**area**       : ext_proc  
**summary**    : ext_proc: propagate detailed GRPC status for fail open (#40808)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [0685d7bf568485eb112df2a9c73248cb8bfc1c37](https://github.com/envoyproxy/envoy/commit/0685d7bf568485eb112df2a9c73248cb8bfc1c37) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40808](https://github.com/envoyproxy/envoy/pull/40808) [41491](https://github.com/envoyproxy/envoy/pull/41491) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
If [failure_mode_allow](/docs/envoy/latest/api-v3/extensions/filters/http/ext_proc/v3/ext_proc.proto#envoy-v3-api-field-extensions-filters-http-ext-proc-v3-externalprocessor-failure-mode-allow) is ``true``, save the gRPC failure status code returned from the ext_proc server in the filter state. Previously, all fail-open cases would return ``call_status`` ``Grpc::Status::Aborted``.   
 
---

**category**   : minor_behavior_changes  
**area**       : dns_filter  
**summary**    : Dns filter: Support bootstrap default DNS resolver config if filter client_config is missing (#41006)  
**commit**     : [73535ee33370577943440a056a57048461e90e35](https://github.com/envoyproxy/envoy/commit/73535ee33370577943440a056a57048461e90e35)  
**pr**         : [41006](https://github.com/envoyproxy/envoy/pull/41006)  
**description**:  
Honor the default DNS resolver configuration in the bootstrap config [typed_dns_resolver_config](/docs/envoy/latest/api-v3/config/bootstrap/v3/bootstrap.proto#envoy-v3-api-field-config-bootstrap-v3-bootstrap-typed-dns-resolver-config) if the [client_config](/docs/envoy/latest/api-v3/extensions/filters/udp/dns_filter/v3/dns_filter.proto#envoy-v3-api-field-extensions-filters-udp-dns-filter-v3-dnsfilterconfig-client-config) is empty.   
 
---

**category**   : minor_behavior_changes  
**area**       : grpc_json_transcoder  
**summary**    : [json_transcoder_filter] Cap grpc stream frame size (#41115)  
**summary**    : changelog: addressing some nits in the change logs before release  (#41497)  
**commit**     : [46227d85aaa71fc0a183f279d6869498e28c6651](https://github.com/envoyproxy/envoy/commit/46227d85aaa71fc0a183f279d6869498e28c6651) [6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9](https://github.com/envoyproxy/envoy/commit/6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9)  
**pr**         : [41115](https://github.com/envoyproxy/envoy/pull/41115) [41497](https://github.com/envoyproxy/envoy/pull/41497)  
**description**:  
Cap the frame size for streamed gRPC at 1MB. Without this change there was a small chance that if a request streamed in sufficiently faster than it was processed, a frame larger than 4MB could be encoded, which most upstream gRPC services would, by default, treat as an error.   
 
---

**category**   : minor_behavior_changes  
**area**       : ext_authz  
**summary**    : ext_authz: check request header map count after applying mutations (#41122)  
**summary**    : router: Connection metadata subset match (#41277)  
**commit**     : [ac9d8ba9a8f239ccee911d8a40dd35d43ed63f72](https://github.com/envoyproxy/envoy/commit/ac9d8ba9a8f239ccee911d8a40dd35d43ed63f72) [f418c1d783d0cc013e15b3123cd3fe739db568eb](https://github.com/envoyproxy/envoy/commit/f418c1d783d0cc013e15b3123cd3fe739db568eb)  
**pr**         : [41122](https://github.com/envoyproxy/envoy/pull/41122) [41277](https://github.com/envoyproxy/envoy/pull/41277)  
**description**:  
Check the request header count after applying mutations is <= the configured limit and reject the response if not.   
 
---

**category**   : minor_behavior_changes  
**area**       : router  
**summary**    : router: Connection metadata subset match (#41277)  
**commit**     : [f418c1d783d0cc013e15b3123cd3fe739db568eb](https://github.com/envoyproxy/envoy/commit/f418c1d783d0cc013e15b3123cd3fe739db568eb)  
**pr**         : [41277](https://github.com/envoyproxy/envoy/pull/41277)  
**description**:  
Take into account connection-level metadata under the ``envoy.lb`` namespace when computing subset load balancing matches.   
 
---

## bug_fixes

**category**   : bug_fixes  
**area**       : tcp_proxy  
**summary**    : tcp_proxy: set idle timeout on downstream connections with no upstream connection (#40841)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [4ba66f66d628d103e8fd41bc5ce61149a8d7d9b3](https://github.com/envoyproxy/envoy/commit/4ba66f66d628d103e8fd41bc5ce61149a8d7d9b3) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40841](https://github.com/envoyproxy/envoy/pull/40841) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Fixed a bug where when a downstream TCP connection is created and the upstream connection is not fully established, no idle timeout is set on the downstream connection, which may lead to a connection leak if the client does not close the connection. The fix is to set an idle timeout on the downstream connection immediately after creation. This fix can be reverted by setting the runtime guard ``envoy.reloadable_features.tcp_proxy_set_idle_timer_immediately_on_new_connection`` to ``false``.   
 
---

**category**   : bug_fixes  
**area**       : udp_proxy  
**summary**    : udp_proxy: Fix crash during ENVOY_SIGTERM (#40677)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [f5446155d7e069e2775a55ca557103500ed34bca](https://github.com/envoyproxy/envoy/commit/f5446155d7e069e2775a55ca557103500ed34bca) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40677](https://github.com/envoyproxy/envoy/pull/40677) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Fixed a crash in the UDP proxy that occurred during ``ENVOY_SIGTERM`` when active tunneling sessions were present.   
 
---

**category**   : bug_fixes  
**area**       : geoip  
**summary**    : maxmind geoip provider: fix bug for no entry found (#40365)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [b0c33ac4a58e65e22fcac0426fe12800dd4a8564](https://github.com/envoyproxy/envoy/commit/b0c33ac4a58e65e22fcac0426fe12800dd4a8564) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40365](https://github.com/envoyproxy/envoy/pull/40365) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Fixed a bug in the MaxMind provider where the ``found_entry`` field in the lookup result was not checked before trying to populate headers with data. If this field is not checked the provider could try to populate headers with wrong data, as per the documentation for the MaxMind library `libmaxminddb.md <https://github.com/maxmind/libmaxminddb/blob/main/doc/libmaxminddb.md#mmdb_lookup_result_s>`_.   
 
---

**category**   : bug_fixes  
**area**       : http3  
**summary**    : quic: fix defer logging for half closed stream (#40449)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [f334a6cc614c5bf9f68e0c26220ae5e81f2bbcb8](https://github.com/envoyproxy/envoy/commit/f334a6cc614c5bf9f68e0c26220ae5e81f2bbcb8) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40449](https://github.com/envoyproxy/envoy/pull/40449) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Fixed a bug where the access log was skipped for HTTP/3 requests when the stream was half closed. This behavior can be reverted by setting the runtime guard ``envoy.reloadable_features.quic_fix_defer_logging_miss_for_half_closed_stream`` to ``false``.   
 
---

**category**   : bug_fixes  
**area**       : load_balancing  
**summary**    : Change `ClientSideWeightedRoundRobinLoadBalancer::WorkerLocalLbFactory::applyWeightsToAllWorkers()` to iterate over priorities on the thread local worker's priority set. (#40479)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [9134b22738f0e313b9f0b687cda03274563e00f0](https://github.com/envoyproxy/envoy/commit/9134b22738f0e313b9f0b687cda03274563e00f0) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [40479](https://github.com/envoyproxy/envoy/pull/40479) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
Fixed a bug in ``ClientSideWeightedRoundRobinLoadBalancer`` with worker lbs iterating over priorities included in owning thread aware lb priority set that might have different number of priorities.   
 
---

**category**   : bug_fixes  
**area**       : http  
**summary**    : http: fix a bug where premature resets may result in recursive drain (#40714)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [69fe44b9ddb82fe10b1ff0e23d491323756c34f9](https://github.com/envoyproxy/envoy/commit/69fe44b9ddb82fe10b1ff0e23d491323756c34f9) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40714](https://github.com/envoyproxy/envoy/pull/40714) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Fixed a bug where premature resets of streams could result in recursive draining and a potential stack overflow. Setting a proper ``max_concurrent_streams`` value for HTTP/2 or HTTP/3 could eliminate the risk of a stack overflow before this fix.   
 
---

**category**   : bug_fixes  
**area**       : listener  
**summary**    : listener: Consider network namespace in address comparison (#41103)  
**commit**     : [1b02aa21fa26bbb5a3bf496cb65780216659174d](https://github.com/envoyproxy/envoy/commit/1b02aa21fa26bbb5a3bf496cb65780216659174d)  
**pr**         : [41103](https://github.com/envoyproxy/envoy/pull/41103)  
**description**:  
Fixed a bug where comparing listeners did not consider the network namespace they were listening in.   
 
---

**category**   : bug_fixes  
**area**       : http  
**summary**    : router: fix a bug where header mutations may not be processed properly (#40856)  
**commit**     : [25f893b44c9ac785d57f21399fb5aff540f0bef7](https://github.com/envoyproxy/envoy/commit/25f893b44c9ac785d57f21399fb5aff540f0bef7)  
**pr**         : [40856](https://github.com/envoyproxy/envoy/pull/40856)  
**description**:  
Fixed a bug where the ``response_headers_to_add`` may be processed multiple times for the local responses from the router filter.   
 
---

**category**   : bug_fixes  
**area**       : formatter  
**summary**    : fix: fix substitution formatter for header mutation (#40905)  
**commit**     : [7ced9f43c09576b7f6dc9fbd7c76333f57686d48](https://github.com/envoyproxy/envoy/commit/7ced9f43c09576b7f6dc9fbd7c76333f57686d48)  
**pr**         : [40905](https://github.com/envoyproxy/envoy/pull/40905)  
**description**:  
Fixed a bug where the ``%TRACE_ID%`` command cannot work properly at the header mutations.   
 
---

**category**   : bug_fixes  
**area**       : listeners  
**summary**    : bugfix: tls_inspector times out (#40544)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [10b7a4cf4c8ef77f3d07fc15a00f6e1fd8ff0a19](https://github.com/envoyproxy/envoy/commit/10b7a4cf4c8ef77f3d07fc15a00f6e1fd8ff0a19) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40544](https://github.com/envoyproxy/envoy/pull/40544) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Fixed an issue where [TLS]() timed out when used with other listener filters. The bug was triggered when a previous listener filter processed more data than the TLS inspector had requested, causing the TLS inspector to incorrectly calculate its buffer growth strategy. The fix ensures that buffer growth is now based on actual bytes available rather than the previously requested amount.   
 
---

**category**   : bug_fixes  
**area**       : listener  
**summary**    : listener: Fix incorrect error status handling when failing to change netns (#40933)  
**commit**     : [437946fcbdb4861e09d4d64df83d194b5afe3c57](https://github.com/envoyproxy/envoy/commit/437946fcbdb4861e09d4d64df83d194b5afe3c57)  
**pr**         : [40933](https://github.com/envoyproxy/envoy/pull/40933)  
**description**:  
Fixed a bug where a failure to create listener sockets in different Linux network namespaces was not handled properly. The success of the netns switch was not checked before attempting to access the result of the socket creation. This is only relevant for Linux and if a listening socket address was specified with a non-default network namespace.   
 
---

**category**   : bug_fixes  
**area**       : aws  
**summary**    : aws: assumerole missing protobuf validations (#40273)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [618e4480c92a2e6d790c4945d71b703c10737beb](https://github.com/envoyproxy/envoy/commit/618e4480c92a2e6d790c4945d71b703c10737beb) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [40273](https://github.com/envoyproxy/envoy/pull/40273) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
Added missing session name, session duration, and ``external_id`` parameters in ``AssumeRole`` credentials provider.   
 
---

**category**   : bug_fixes  
**area**       : oauth2  
**summary**    : oauth2: fix passthrough logic to avoid modifying request when skipping filter (#40718)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [d9e0412bd471a80e0938102c0c8cbff1caedd4cf](https://github.com/envoyproxy/envoy/commit/d9e0412bd471a80e0938102c0c8cbff1caedd4cf) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [40718](https://github.com/envoyproxy/envoy/pull/40718) [41161](https://github.com/envoyproxy/envoy/pull/41161) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
Fixed a bug introduced in PR `#40228 <https://github.com/envoyproxy/envoy/pull/40228>`_, where OAuth2 cookies were removed for requests matching the ``pass_through_matcher`` configuration. This broke setups with multiple OAuth2 filter instances using different ``pass_through_matcher`` configurations, because the first matching instance removed the OAuth2 cookies - even when a passthrough was intended - impacting subsequent filters that still needed those cookies.   
 
---

**category**   : bug_fixes  
**area**       : tls_inspector  
**summary**    : tls_inspector: do not close plain text connections for >16Kb reads (#40911)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [f8bdb3ebd88477c7325f796f874b8cee1773367f](https://github.com/envoyproxy/envoy/commit/f8bdb3ebd88477c7325f796f874b8cee1773367f) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [40911](https://github.com/envoyproxy/envoy/pull/40911) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
Fixed regression in tls_inspector that caused plain text connections to be closed if more than 16Kb is read at once. This behavior can be reverted by setting the runtime guard ``envoy.reloadable_features.tls_inspector_no_length_check_on_error`` to ``false``.   
 
---

**category**   : bug_fixes  
**area**       : stats  
**summary**    : stats: fix a bug where the prometheus name of ssl certificate stats are wrong (#40891)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [46313ac4e6bc2250d0948cc1cceb543ad16ccc88](https://github.com/envoyproxy/envoy/commit/46313ac4e6bc2250d0948cc1cceb543ad16ccc88) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40891](https://github.com/envoyproxy/envoy/pull/40891) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Fixed a bug where the metric name ``expiration_unix_time_seconds`` of ``cluster.<cluster_name>.ssl.certificate.<cert_name>.<metric_name>`` and ``listener.<address>.ssl.certificate.<cert_name>.<metric_name>`` was not being properly extracted in the final Prometheus stat name.   
 
---

**category**   : bug_fixes  
**area**       : odcds  
**summary**    : odcds: convert ODCDS over ADS to pre-cluster-single-subscription (#41174)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [d5c7a06f92f2a26ce2bda9d96b2a461c1f8f39ff](https://github.com/envoyproxy/envoy/commit/d5c7a06f92f2a26ce2bda9d96b2a461c1f8f39ff) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [41174](https://github.com/envoyproxy/envoy/pull/41174) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
Fixed a bug where using OD-CDS without ``cds_config`` would not work in some cases. This change introduces a new internal OD-CDS component. This change could be reverted temporarily by setting the runtime guard ``envoy.reloadable_features.odcds_over_ads_fix`` to ``false``.   
 
---

**category**   : bug_fixes  
**area**       : oauth2  
**summary**    : oauth2: add Secure attribute for prefixed cookies on signout  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [f9a24c0b1b0224fa4b3816c903ebd0f6e09379de](https://github.com/envoyproxy/envoy/commit/f9a24c0b1b0224fa4b3816c903ebd0f6e09379de) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Fixed an issue where cookies prefixed with ``__Secure-`` or ``__Host-`` were not receiving a ``Secure`` attribute.   
 
---

**category**   : bug_fixes  
**area**       : dns  
**summary**    : Fixed an UAF in DNS cache (#1709)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [a3f6c1c6d58978a0075c5365adab6e0d15673f48](https://github.com/envoyproxy/envoy/commit/a3f6c1c6d58978a0075c5365adab6e0d15673f48) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [1709](https://github.com/envoyproxy/envoy/pull/1709) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Fixed a use-after-free (UAF) in DNS cache that can occur when the ``Host`` header is modified between the Dynamic Forwarding Proxy and Router filters.   
 
---

**category**   : bug_fixes  
**area**       : release  
**summary**    : changelog: Add for docker/distroless fix (#40980)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [0f7d63e81474266339e492213a334f41772a5486](https://github.com/envoyproxy/envoy/commit/0f7d63e81474266339e492213a334f41772a5486) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40980](https://github.com/envoyproxy/envoy/pull/40980) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Fixed the distroless image to ensure nonroot.   
 
---

## removed_config_or_runtime

**category**   : removed_config_or_runtime  
**area**       : router  
**summary**    : router: deprecate flag shadow_policy_inherit_trace_sampling and remove legacy code paths (#40394)  
**commit**     : [3333b8c55d629270f6eea5b39fb90e26b85c45b0](https://github.com/envoyproxy/envoy/commit/3333b8c55d629270f6eea5b39fb90e26b85c45b0)  
**pr**         : [40394](https://github.com/envoyproxy/envoy/pull/40394)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.shadow_policy_inherit_trace_sampling`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : dns  
**summary**    : dns: deprecate flag prefer_ipv6_dns_on_macos and remove legacy code paths (#40549)  
**commit**     : [d8d228ca19ad0f7c0bbc943b59fe0dea636d2735](https://github.com/envoyproxy/envoy/commit/d8d228ca19ad0f7c0bbc943b59fe0dea636d2735)  
**pr**         : [40549](https://github.com/envoyproxy/envoy/pull/40549)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.prefer_ipv6_dns_on_macos`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : dynamic_forward_proxy  
**summary**    : dfp: deprecate flag avoid_dfp_cluster_removal_on_cds_update and remove legacy code paths (#40396)  
**commit**     : [4c44af6f07eae1fed5f0e677641c92b8a2a4ff9d](https://github.com/envoyproxy/envoy/commit/4c44af6f07eae1fed5f0e677641c92b8a2a4ff9d)  
**pr**         : [40396](https://github.com/envoyproxy/envoy/pull/40396)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.avoid_dfp_cluster_removal_on_cds_update`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : oauth2  
**summary**    : oauth2: deprecate flag oauth2_use_refresh_token and remove legacy code paths (#40397)  
**commit**     : [6592881fed782d79597d64222f03995d05552271](https://github.com/envoyproxy/envoy/commit/6592881fed782d79597d64222f03995d05552271)  
**pr**         : [40397](https://github.com/envoyproxy/envoy/pull/40397)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.oauth2_use_refresh_token`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http_connection_manager  
**summary**    : hcm: deprecate flag explicit_internal_address_config and remove legacy code paths (#40398)  
**commit**     : [ca73fe4aef97a06340ef8e74cabe6aa8af3a5928](https://github.com/envoyproxy/envoy/commit/ca73fe4aef97a06340ef8e74cabe6aa8af3a5928)  
**pr**         : [40398](https://github.com/envoyproxy/envoy/pull/40398)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.explicit_internal_address_config`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : dfp  
**summary**    : runtime: remove envoy.reloadable_features.dfp_fail_on_empty_host_header (#40445)  
**commit**     : [7d45be5107a15e28708a720103ca43aff2d53227](https://github.com/envoyproxy/envoy/commit/7d45be5107a15e28708a720103ca43aff2d53227)  
**pr**         : [40445](https://github.com/envoyproxy/envoy/pull/40445)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.dfp_fail_on_empty_host_header`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : quic  
**summary**    : runtime: Deprecate runtime guard `prefer_quic_client_udp_gro` (#40501)  
**commit**     : [1835695578f5d2a9a37fc59d65edc24b1174c3c0](https://github.com/envoyproxy/envoy/commit/1835695578f5d2a9a37fc59d65edc24b1174c3c0)  
**pr**         : [40501](https://github.com/envoyproxy/envoy/pull/40501)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.prefer_quic_client_udp_gro`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : udp_proxy  
**summary**    : udp_proxy: deprecate flag enable_udp_proxy_outlier_detection and remove legacy code paths (#40512)  
**commit**     : [001b8595e084db6f469596ef6aa7f0aac2f001a8](https://github.com/envoyproxy/envoy/commit/001b8595e084db6f469596ef6aa7f0aac2f001a8)  
**pr**         : [40512](https://github.com/envoyproxy/envoy/pull/40512)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.enable_udp_proxy_outlier_detection`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : xds  
**summary**    : xds: deprecate flag xds_prevent_resource_copy and remove legacy code paths (#40676)  
**commit**     : [501a109714333fa07df45b1fef545f187a86e279](https://github.com/envoyproxy/envoy/commit/501a109714333fa07df45b1fef545f187a86e279)  
**pr**         : [40676](https://github.com/envoyproxy/envoy/pull/40676)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.xds_prevent_resource_copy`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : rds  
**summary**    : rds: deprecate flag normalize_rds_provider_config and remove legacy code paths (#40660)  
**commit**     : [d9bda64c848ae34449ccac6efc2c6a18b8b44a3f](https://github.com/envoyproxy/envoy/commit/d9bda64c848ae34449ccac6efc2c6a18b8b44a3f)  
**pr**         : [40660](https://github.com/envoyproxy/envoy/pull/40660)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.normalize_rds_provider_config`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http  
**summary**    : http: deprecate flag local_reply_traverses_filter_chain_after_1xx and remove legacy code paths (#40665)  
**commit**     : [14410a9f89624d6071aff8f598a1d4626a7dda95](https://github.com/envoyproxy/envoy/commit/14410a9f89624d6071aff8f598a1d4626a7dda95)  
**pr**         : [40665](https://github.com/envoyproxy/envoy/pull/40665)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.local_reply_traverses_filter_chain_after_1xx`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : quic  
**summary**    : quic: deprecate flag report_stream_reset_error_code and remove legacy code paths (#40592)  
**commit**     : [c3ad18af95fd23d6383f0cd237cb048115346d54](https://github.com/envoyproxy/envoy/commit/c3ad18af95fd23d6383f0cd237cb048115346d54)  
**pr**         : [40592](https://github.com/envoyproxy/envoy/pull/40592)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.report_stream_reset_error_code`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : router  
**summary**    : router: deprecate flag streaming_shadow and remove legacy code paths (#40659)  
**commit**     : [0e923a2444b4077e94cba97c2a82fa47b4dcab06](https://github.com/envoyproxy/envoy/commit/0e923a2444b4077e94cba97c2a82fa47b4dcab06)  
**pr**         : [40659](https://github.com/envoyproxy/envoy/pull/40659)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.streaming_shadow`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http3  
**summary**    : http3: deprecate flag http3_remove_empty_trailers and remove legacy code paths (#40596)  
**commit**     : [3e3cfd2cd96bd27259bc4eb12113cf7d89e421f8](https://github.com/envoyproxy/envoy/commit/3e3cfd2cd96bd27259bc4eb12113cf7d89e421f8)  
**pr**         : [40596](https://github.com/envoyproxy/envoy/pull/40596)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.http3_remove_empty_trailers`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : stats  
**summary**    : stats: deprecate flag enable_include_histograms and remove legacy code paths (#40606)  
**commit**     : [624af8eb53a7e70f7857e11330b075aa6c6087f3](https://github.com/envoyproxy/envoy/commit/624af8eb53a7e70f7857e11330b075aa6c6087f3)  
**pr**         : [40606](https://github.com/envoyproxy/envoy/pull/40606)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.enable_include_histograms`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : network  
**summary**    : network: deprecate flag udp_socket_apply_aggregated_read_limit and remove legacy code paths (#40591)  
**commit**     : [452399a56c978d83d7bd1e8f99c98cf72fa3a500](https://github.com/envoyproxy/envoy/commit/452399a56c978d83d7bd1e8f99c98cf72fa3a500)  
**pr**         : [40591](https://github.com/envoyproxy/envoy/pull/40591)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.udp_socket_apply_aggregated_read_limit`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http  
**summary**    : http: deprecate flag filter_chain_aborted_can_not_continue and remove legacy code paths (#40511)  
**summary**    : http: deprecate flag proxy_status_mapping_more_core_response_flags and remove legacy code paths (#40608)  
**commit**     : [d4e8cb1be6baff02d7f512a2a40add07cc5ca82c](https://github.com/envoyproxy/envoy/commit/d4e8cb1be6baff02d7f512a2a40add07cc5ca82c) [4a134ce926cf0b882a4c416734b579f9722ed1eb](https://github.com/envoyproxy/envoy/commit/4a134ce926cf0b882a4c416734b579f9722ed1eb)  
**pr**         : [40511](https://github.com/envoyproxy/envoy/pull/40511) [40608](https://github.com/envoyproxy/envoy/pull/40608)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.proxy_status_mapping_more_core_response_flags`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http  
**summary**    : http: deprecate flag proxy_status_mapping_more_core_response_flags and remove legacy code paths (#40608)  
**summary**    : http: deprecate flag allow_alt_svc_for_ips and remove legacy code paths (#40594)  
**commit**     : [4a134ce926cf0b882a4c416734b579f9722ed1eb](https://github.com/envoyproxy/envoy/commit/4a134ce926cf0b882a4c416734b579f9722ed1eb) [413c63f1f6dcb508693942f451135de210edd43f](https://github.com/envoyproxy/envoy/commit/413c63f1f6dcb508693942f451135de210edd43f)  
**pr**         : [40608](https://github.com/envoyproxy/envoy/pull/40608) [40594](https://github.com/envoyproxy/envoy/pull/40594)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.allow_alt_svc_for_ips`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http  
**summary**    : http: deprecate flag allow_alt_svc_for_ips and remove legacy code paths (#40594)  
**summary**    : http: deprecate flag filter_chain_aborted_can_not_continue and remove legacy code paths (#40511)  
**commit**     : [413c63f1f6dcb508693942f451135de210edd43f](https://github.com/envoyproxy/envoy/commit/413c63f1f6dcb508693942f451135de210edd43f) [d4e8cb1be6baff02d7f512a2a40add07cc5ca82c](https://github.com/envoyproxy/envoy/commit/d4e8cb1be6baff02d7f512a2a40add07cc5ca82c)  
**pr**         : [40594](https://github.com/envoyproxy/envoy/pull/40594) [40511](https://github.com/envoyproxy/envoy/pull/40511)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.filter_chain_aborted_can_not_continue`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http  
**summary**    : http: deprecate flag use_filter_manager_state_for_downstream_end_stream and remove legacy code paths (#40610)  
**commit**     : [7c92b7ae8db8a14aff24a4d799acb718134b3ec9](https://github.com/envoyproxy/envoy/commit/7c92b7ae8db8a14aff24a4d799acb718134b3ec9)  
**pr**         : [40610](https://github.com/envoyproxy/envoy/pull/40610)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.use_filter_manager_state_for_downstream_end_stream`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : balsa  
**summary**    : balsa: deprecate flag wait_for_first_byte_before_balsa_msg_done and remove legacy code paths (#40666)  
**commit**     : [4e386b999ef6e9f3f6332aa651ab79863288c3b0](https://github.com/envoyproxy/envoy/commit/4e386b999ef6e9f3f6332aa651ab79863288c3b0)  
**pr**         : [40666](https://github.com/envoyproxy/envoy/pull/40666)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.wait_for_first_byte_before_balsa_msg_done`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : geoip_providers  
**summary**    : geoip_providers: deprecate flag mmdb_files_reload_enabled and remove legacy code paths (#40548)  
**commit**     : [89a789a1c9f45bf916a687a720130210076ab1ce](https://github.com/envoyproxy/envoy/commit/89a789a1c9f45bf916a687a720130210076ab1ce)  
**pr**         : [40548](https://github.com/envoyproxy/envoy/pull/40548)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.mmdb_files_reload_enabled`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : proxy_protocol  
**summary**    : proxy_protocol: deprecate flag use_typed_metadata_in_proxy_protocol_listener and remove legacy code paths (#40609)  
**commit**     : [b2d357c52f727c8f0459620f8b29295fb01dc0f0](https://github.com/envoyproxy/envoy/commit/b2d357c52f727c8f0459620f8b29295fb01dc0f0)  
**pr**         : [40609](https://github.com/envoyproxy/envoy/pull/40609)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.use_typed_metadata_in_proxy_protocol_listener`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : dns_resolver  
**summary**    : dns_resolver: deprecate flag getaddrinfo_num_retries and remove legacy code paths (#40547)  
**commit**     : [e9aa0a4a94ffe0e46a68d7c83f38cb5c4d668b76](https://github.com/envoyproxy/envoy/commit/e9aa0a4a94ffe0e46a68d7c83f38cb5c4d668b76)  
**pr**         : [40547](https://github.com/envoyproxy/envoy/pull/40547)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.getaddrinfo_num_retries`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : proxy_filter  
**summary**    : proxy_filter: deprecate flag proxy_ssl_port and remove legacy code paths (#40550)  
**commit**     : [506fe86f569f041f676ed3aa8435d8d5e896d0b9](https://github.com/envoyproxy/envoy/commit/506fe86f569f041f676ed3aa8435d8d5e896d0b9)  
**pr**         : [40550](https://github.com/envoyproxy/envoy/pull/40550)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.proxy_ssl_port`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : gcp_authn  
**summary**    : gcp_authn: deprecate flag gcp_authn_use_fixed_url and remove legacy code paths (#40546)  
**commit**     : [9eaac4bdc7671ba3e6c26343d786638f1068094e](https://github.com/envoyproxy/envoy/commit/9eaac4bdc7671ba3e6c26343d786638f1068094e)  
**pr**         : [40546](https://github.com/envoyproxy/envoy/pull/40546)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.gcp_authn_use_fixed_url`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : jwt_authn  
**summary**    : jwt_authn: deprecate flag jwt_authn_remove_jwt_from_query_params and remove legacy code paths (#40555)  
**commit**     : [e37e039bf4e8388a94052e7b80906d11bd4412ec](https://github.com/envoyproxy/envoy/commit/e37e039bf4e8388a94052e7b80906d11bd4412ec)  
**pr**         : [40555](https://github.com/envoyproxy/envoy/pull/40555)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.jwt_authn_remove_jwt_from_query_params`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : jwt_authn  
**summary**    : jwt_authn: deprecate flag jwt_authn_validate_uri and remove legacy code paths (#40586)  
**commit**     : [86dbda9d7dd3532cb80f4bb7d703665b2b8998d8](https://github.com/envoyproxy/envoy/commit/86dbda9d7dd3532cb80f4bb7d703665b2b8998d8)  
**pr**         : [40586](https://github.com/envoyproxy/envoy/pull/40586)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.jwt_authn_validate_uri`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : dispatcher  
**summary**    : dispatcher: deprecate flag fix_dispatcher_approximate_now and remove legacy code paths (#40553)  
**commit**     : [f05829cbe1903d963c77870a377c2ee999bc4f94](https://github.com/envoyproxy/envoy/commit/f05829cbe1903d963c77870a377c2ee999bc4f94)  
**pr**         : [40553](https://github.com/envoyproxy/envoy/pull/40553)  
**description**:  
Removed runtime guard ``envoy.restart_features.fix_dispatcher_approximate_now`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : upstream  
**summary**    : upstream: deprecate flag use_config_in_happy_eyeballs and remove legacy code paths (#40552)  
**commit**     : [d8b03d2ab25aa729287ec1f4a9ed7325382a2f2a](https://github.com/envoyproxy/envoy/commit/d8b03d2ab25aa729287ec1f4a9ed7325382a2f2a)  
**pr**         : [40552](https://github.com/envoyproxy/envoy/pull/40552)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.use_config_in_happy_eyeballs`` and legacy code paths.   
 
---

**category**   : removed_config_or_runtime  
**area**       : http  
**summary**    : http: deprecate flag proxy_104 and remove legacy code paths (#40554)  
**commit**     : [b52d8e7f33b47abb081b827feae0c937d1343c80](https://github.com/envoyproxy/envoy/commit/b52d8e7f33b47abb081b827feae0c937d1343c80)  
**pr**         : [40554](https://github.com/envoyproxy/envoy/pull/40554)  
**description**:  
Removed runtime guard ``envoy.reloadable_features.proxy_104`` and legacy code paths.   
 
---

## new_features

**category**   : new_features  
**area**       : router  
**summary**    : feat: use route hash_policy for weighted cluster as well (#41244)  
**commit**     : [11162bf23e512b5a527246c78d80262d2285512a](https://github.com/envoyproxy/envoy/commit/11162bf23e512b5a527246c78d80262d2285512a)  
**pr**         : [41244](https://github.com/envoyproxy/envoy/pull/41244)  
**description**:  
Added [use_hash_policy](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-weightedcluster-use-hash-policy) field to [WeightedCluster](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-msg-config-route-v3-weightedcluster) to enable route-level hash policies for weighted cluster selection. When set to ``true``, the existing route-level [hash_policy](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-routeaction-hash-policy) will be used for consistent hashing between weighted clusters, ensuring that requests with the same hash value (e.g., same session ID, user ID, etc.) will consistently be routed to the same weighted cluster, enabling session affinity and consistent load balancing behavior.   
 
---

**category**   : new_features  
**area**       : stats  
**summary**    : stats: metric expiry (#40395)  
**commit**     : [45c37454c7acea764b5bdae2490da9dd81c1e088](https://github.com/envoyproxy/envoy/commit/45c37454c7acea764b5bdae2490da9dd81c1e088)  
**pr**         : [40395](https://github.com/envoyproxy/envoy/pull/40395)  
**description**:  
Added support to remove unused metrics from memory for extensions that support evictable metrics. This is done [periodically](/docs/envoy/latest/api-v3/config/bootstrap/v3/bootstrap.proto#envoy-v3-api-field-config-bootstrap-v3-bootstrap-stats-eviction-interval) during the metric flush.   
 
---

**category**   : new_features  
**area**       : http  
**summary**    : http: add stats for stateful session filter (#41236)  
**commit**     : [21b70d126c0a5c16d844658ee2db68f94deb7548](https://github.com/envoyproxy/envoy/commit/21b70d126c0a5c16d844658ee2db68f94deb7548)  
**pr**         : [41236](https://github.com/envoyproxy/envoy/pull/41236)  
**description**:  
Added statistics to the [Stateful]() to help operators understand routing outcomes when session overrides are requested. The filter now emits counters in the ``http.<stat_prefix>.stateful_session.[<filter_stat_prefix>.]`` namespace. An optional per-filter [stat_prefix](/docs/envoy/latest/api-v3/extensions/filters/http/stateful_session/v3/stateful_session.proto#envoy-v3-api-field-extensions-filters-http-stateful-session-v3-statefulsession-stat-prefix) can be used to disambiguate multiple instances.   
 
---

**category**   : new_features  
**area**       : tap  
**summary**    : Ext/Filter/http/Tap: Record the upstream connection information in the HTTP buffer trace output (#40875)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [efa7b430abb408207577a4c65c4ff79e89c43663](https://github.com/envoyproxy/envoy/commit/efa7b430abb408207577a4c65c4ff79e89c43663) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40875](https://github.com/envoyproxy/envoy/pull/40875) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Added [record_upstream_connection](/docs/envoy/latest/api-v3/extensions/filters/http/tap/v3/tap.proto#envoy-v3-api-field-extensions-filters-http-tap-v3-tap-record-upstream-connection) to determine whether upstream connection information is recorded in the HTTP buffer trace output.   
 
---

**category**   : new_features  
**area**       : quic  
**summary**    : quic-lb: add support for base64 encoded server_id (#40400)  
**commit**     : [0bb61cf19fa257d5be29083c65ba502da20b4849](https://github.com/envoyproxy/envoy/commit/0bb61cf19fa257d5be29083c65ba502da20b4849)  
**pr**         : [40400](https://github.com/envoyproxy/envoy/pull/40400)  
**description**:  
Added new option to support [base64]() in QUIC-LB.   
 
---

**category**   : new_features  
**area**       : health_check  
**summary**    : health_check: add request payload support for HTTP health checks (#40322)  
**summary**    : changelog: fix typos in the current change logs and clean them up (#40481)  
**commit**     : [add95334c7a1e6c0088008145954dcfa39cb18af](https://github.com/envoyproxy/envoy/commit/add95334c7a1e6c0088008145954dcfa39cb18af) [bc253caa737d2797ad74582a87c35f1851729b6c](https://github.com/envoyproxy/envoy/commit/bc253caa737d2797ad74582a87c35f1851729b6c)  
**pr**         : [40322](https://github.com/envoyproxy/envoy/pull/40322) [40481](https://github.com/envoyproxy/envoy/pull/40481)  
**description**:  
Added support for request payloads in HTTP health checks. The ``send`` field in ``HttpHealthCheck`` can now be used to specify a request body to be sent during health checking. This feature supports both hex-encoded text and binary payloads, similar to TCP health checks. The payload can only be used with HTTP methods that support request bodies (``POST``, ``PUT``, ``PATCH``, ``OPTIONS``). Methods that must not have request bodies (``GET``, ``HEAD``, ``DELETE``, ``TRACE``) are validated and will throw an error if combined with payloads. The implementation is optimized to process the payload once during configuration and reuse it for all health check requests. See [HttpHealthCheck](/docs/envoy/latest/api-v3/config/core/v3/health_check.proto#envoy-v3-api-msg-config-core-v3-healthcheck-httphealthcheck) for configuration details.   
 
---

**category**   : new_features  
**area**       : tcp_proxy  
**summary**    : tcp_proxy: add support for generating request ID for tunneling (#40815)  
**commit**     : [e06aa8ea5a4483eaa1dac22b5db977b45c02e37c](https://github.com/envoyproxy/envoy/commit/e06aa8ea5a4483eaa1dac22b5db977b45c02e37c)  
**pr**         : [40815](https://github.com/envoyproxy/envoy/pull/40815)  
**description**:  
Added support for generating and propagating a request ID on synthesized upstream HTTP requests when tunneling requests. It can be configured using [request_id_extension](/docs/envoy/latest/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-tunnelingconfig-request-id-extension).   
 
---

**category**   : new_features  
**area**       : tcp_proxy  
**summary**    : tcp_proxy: add support for overriding generated  request ID for tunneling (#41391)  
**commit**     : [39744b212c5fe2a75a7201815cc8f233a24c3266](https://github.com/envoyproxy/envoy/commit/39744b212c5fe2a75a7201815cc8f233a24c3266)  
**pr**         : [41391](https://github.com/envoyproxy/envoy/pull/41391)  
**description**:  
Added configuration to customize the request ID header and dynamic metadata key used when tunneling requests. Use [request_id_header](/docs/envoy/latest/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-tunnelingconfig-request-id-header) and [request_id_metadata_key](/docs/envoy/latest/api-v3/extensions/filters/network/tcp_proxy/v3/tcp_proxy.proto#envoy-v3-api-field-extensions-filters-network-tcp-proxy-v3-tcpproxy-tunnelingconfig-request-id-metadata-key). When unset, the defaults remain ``x-request-id`` and ``tunnel_request_id`` respectively.   
 
---

**category**   : new_features  
**area**       : http  
**summary**    : compressor: expose compressor_library for per-route overrides (#41177)  
**summary**    : changelog: addressing some nits in the change logs before release  (#41497)  
**commit**     : [e3e4f293d4ff103a034c0ee1f568e05c9bb3b8f2](https://github.com/envoyproxy/envoy/commit/e3e4f293d4ff103a034c0ee1f568e05c9bb3b8f2) [6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9](https://github.com/envoyproxy/envoy/commit/6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9)  
**pr**         : [41177](https://github.com/envoyproxy/envoy/pull/41177) [41497](https://github.com/envoyproxy/envoy/pull/41497)  
**description**:  
Added support for per-route compressor library override in the [compressor](). Routes can now specify a different compressor library (e.g., gzip, brotli) via the [compressor_library](/docs/envoy/latest/api-v3/extensions/filters/http/compressor/v3/compressor.proto#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressoroverrides-compressor-library) field in the per-route configuration. This allows different routes to use different compression algorithms and settings while maintaining the same filter configuration.   
 
---

**category**   : new_features  
**area**       : router_check_tool  
**summary**    : router_check: add support for dynamic_metadata in router_check tool tests (#40131)  
**commit**     : [c5505765a5871cd314f159cb8e4b978c9eed3302](https://github.com/envoyproxy/envoy/commit/c5505765a5871cd314f159cb8e4b978c9eed3302)  
**pr**         : [40131](https://github.com/envoyproxy/envoy/pull/40131)  
**description**:  
Added support for testing routes with [dynamic]() in the router check tool. The tool now accepts a ``dynamic_metadata`` field in test input to set metadata that can be matched by route configuration. This allows comprehensive testing of routes that depend on dynamic metadata for routing decisions.   
 
---

**category**   : new_features  
**area**       : oauth2  
**summary**    : oauth2: add disable_token_encryption option (#40903)  
**commit**     : [44ac86c4e4c9ff4b9a85452c1ea3ada075ccc6ed](https://github.com/envoyproxy/envoy/commit/44ac86c4e4c9ff4b9a85452c1ea3ada075ccc6ed)  
**pr**         : [40903](https://github.com/envoyproxy/envoy/pull/40903)  
**description**:  
Added [disable_token_encryption](/docs/envoy/latest/api-v3/extensions/filters/http/oauth2/v3/oauth.proto#envoy-v3-api-field-extensions-filters-http-oauth2-v3-oauth2config-disable-token-encryption) option to the OAuth2 filter to store ID and access tokens without encryption when running in trusted environments.   
 
---

**category**   : new_features  
**area**       : lua  
**summary**    : lua: adds filterState() on streamInfo() (#40023)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [0089fe6cf8d3bddd869b8bfdc5e4619ee99ee5c6](https://github.com/envoyproxy/envoy/commit/0089fe6cf8d3bddd869b8bfdc5e4619ee99ee5c6) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40023](https://github.com/envoyproxy/envoy/pull/40023) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Added a new ``filterState()`` to ``streamInfo()`` which provides access to filter state objects stored during request processing. This allows Lua scripts to retrieve string, boolean, and numeric values stored by various filters for use in routing decisions, header modifications, and other processing logic. See [Filter]() for more details.   
 
---

**category**   : new_features  
**area**       : socket  
**summary**    : upstream: Add network namespace for upstream binding (#39782)  
**summary**    : Reapply "ext_authz: add grpc_service field on the per-route filter" (#40843)  
**commit**     : [d7f5e8cba923b8e3662d2beb617afcc2b8df8391](https://github.com/envoyproxy/envoy/commit/d7f5e8cba923b8e3662d2beb617afcc2b8df8391) [c14c2bbebd92e9ff89fb36bc204c2caa43ba7c13](https://github.com/envoyproxy/envoy/commit/c14c2bbebd92e9ff89fb36bc204c2caa43ba7c13)  
**pr**         : [39782](https://github.com/envoyproxy/envoy/pull/39782) [40843](https://github.com/envoyproxy/envoy/pull/40843)  
**description**:  
Added ``network_namespace_filepath`` to [SocketAddress](/docs/envoy/latest/api-v3/config/core/v3/address.proto#envoy-v3-api-msg-config-core-v3-socketaddress). This field allows specifying a Linux network namespace filepath for socket creation, enabling network isolation in containerized environments.   
 
---

**category**   : new_features  
**area**       : ratelimit  
**summary**    : http ratelimit: Add rate_limits to filter config (#40118)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [0ea0022296e3f31aedc66c556b6112803e4b1b60](https://github.com/envoyproxy/envoy/commit/0ea0022296e3f31aedc66c556b6112803e4b1b60) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40118](https://github.com/envoyproxy/envoy/pull/40118) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Added the [rate_limits](/docs/envoy/latest/api-v3/extensions/filters/http/ratelimit/v3/rate_limit.proto#envoy-v3-api-field-extensions-filters-http-ratelimit-v3-ratelimit-rate-limits) field to generate rate limit descriptors. If this field is set, the [VirtualHost]() or [RouteAction]() fields will be ignored. However, [RateLimitPerRoute]() will take precedence over this field.   
 
---

**category**   : new_features  
**area**       : ratelimit  
**summary**    : ratelimit: support detach request after sent limit request (#40958)  
**commit**     : [b314c6b343515d27fd86b2b2cae859ed24d97cb3](https://github.com/envoyproxy/envoy/commit/b314c6b343515d27fd86b2b2cae859ed24d97cb3)  
**pr**         : [40958](https://github.com/envoyproxy/envoy/pull/40958)  
**description**:  
Enhanced the rate limit filter to support substitution formatters for descriptors that generated at the stream complete phase. Before this change, substitution formatters at the stream complete phase cannot work because rate limit filter does not provide the necessary context.   
 
---

**category**   : new_features  
**area**       : redis  
**summary**    : redis_proxy: Add support for GEOSEARCH (#40534)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [d463b2691b7f2c727fdb7259e454303a8c0d7cd3](https://github.com/envoyproxy/envoy/commit/d463b2691b7f2c727fdb7259e454303a8c0d7cd3) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40534](https://github.com/envoyproxy/envoy/pull/40534) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Added support for thirty-three new Redis commands including ``COPY``, ``RPOPLPUSH``, ``SMOVE``, ``SUNION``, ``SDIFF``, ``SINTER``, ``SINTERSTORE``, ``ZUNIONSTORE``, ``ZINTERSTORE``, ``PFMERGE``, ``GEORADIUS``, ``GEORADIUSBYMEMBER``, ``RENAME``, ``SORT``, ``SORT_RO``, ``ZMSCORE``, ``SDIFFSTORE``, ``MSETNX``, ``SUBSTR``, ``ZRANGESTORE``, ``ZUNION``, ``ZDIFF``, ``SUNIONSTORE``, ``SMISMEMBER``, ``HRANDFIELD``, ``GEOSEARCHSTORE``, ``ZDIFFSTORE``, ``ZINTER``, ``ZRANDMEMBER``, ``BITOP``, ``LPOS``, ``RENAMENX``.   
 
---

**category**   : new_features  
**area**       : observability  
**summary**    : Add ENVOY_NOTIFICATION macro (#40298)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [51aa49768d882a9a58e1ae060ce6df1dd020dc5f](https://github.com/envoyproxy/envoy/commit/51aa49768d882a9a58e1ae060ce6df1dd020dc5f) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40298](https://github.com/envoyproxy/envoy/pull/40298) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Added ``ENVOY_NOTIFICATION`` macro to track specific conditions in production environments.   
 
---

**category**   : new_features  
**area**       : dns_filter, redis_proxy and prefix_matcher_map  
**summary**    : Re-apply "Using Radix tree instead of Trie (#40160)" (#40428)  
**commit**     : [ee2bab9e40e7d7649cc88c5e1098c74e0c79501d](https://github.com/envoyproxy/envoy/commit/ee2bab9e40e7d7649cc88c5e1098c74e0c79501d)  
**pr**         : [40160](https://github.com/envoyproxy/envoy/pull/40160)  
**description**:  
Switch to using Radix Tree instead of Trie for performance improvements.   
 
---

**category**   : new_features  
**area**       : header_to_metadata  
**summary**    : h2m: add optional stats to header-to-metadata filter (#40464)  
**commit**     : [49c5c95df9cac2df93856f8af3269207ef017762](https://github.com/envoyproxy/envoy/commit/49c5c95df9cac2df93856f8af3269207ef017762)  
**pr**         : [40464](https://github.com/envoyproxy/envoy/pull/40464)  
**description**:  
Added optional statistics collection for the Header-To-Metadata filter. When the [stat_prefix](/docs/envoy/latest/api-v3/extensions/filters/http/stateful_session/v3/stateful_session.proto#envoy-v3-api-field-extensions-filters-http-stateful-session-v3-statefulsession-stat-prefix) field is configured, the filter emits detailed counters for rule processing, metadata operations, etc. See [Header]() for details.   
 
---

**category**   : new_features  
**area**       : load_reporting  
**summary**    : config-dump: support endpoint level load stats reporting (#39406)  
**commit**     : [3c0e76f214333fb49bc618c0807dac07dbdbce0f](https://github.com/envoyproxy/envoy/commit/3c0e76f214333fb49bc618c0807dac07dbdbce0f)  
**pr**         : [39406](https://github.com/envoyproxy/envoy/pull/39406)  
**description**:  
Added support for endpoint-level load stats and metrics reporting. Locality load reports now include per endpoint statistics and metrics, but only for endpoints with updated stats, optimizing report size and efficiency.   
 
---

**category**   : new_features  
**area**       : overload management  
**summary**    : add load shed point http2_server_go_away_and_close_on_dispatch (#40480)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [2a9789ef6f0d502948fa40ad313feee874dbdbcd](https://github.com/envoyproxy/envoy/commit/2a9789ef6f0d502948fa40ad313feee874dbdbcd) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40480](https://github.com/envoyproxy/envoy/pull/40480) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Added load shed point ``envoy.load_shed_points.http2_server_go_away_and_close_on_dispatch`` that sends ``GOAWAY`` and closes connections for HTTP/2 server processing of requests. When a ``GOAWAY`` frame is submitted by this load shed point, the counter ``http2.goaway_sent`` will be incremented.   
 
---

**category**   : new_features  
**area**       : router  
**summary**    : router: add request_body_buffer_limit for large request buffering (#40254)  
**commit**     : [369ace259ce3a67e16a1a29331671a533ffa6968](https://github.com/envoyproxy/envoy/commit/369ace259ce3a67e16a1a29331671a533ffa6968)  
**pr**         : [40254](https://github.com/envoyproxy/envoy/pull/40254)  
**description**:  
Added [request_body_buffer_limit](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-route-request-body-buffer-limit) and [request_body_buffer_limit](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-route-request-body-buffer-limit) configuration fields to enable buffering of large request bodies beyond connection buffer limits.   
 
---

**category**   : new_features  
**area**       : otlp_stat_sink  
**summary**    : statSink: add resource attributes for otlp statSink (#40351)  
**commit**     : [3d5e07bf4a495b333fbc78e1e67ae46e2019f6ea](https://github.com/envoyproxy/envoy/commit/3d5e07bf4a495b333fbc78e1e67ae46e2019f6ea)  
**pr**         : [40351](https://github.com/envoyproxy/envoy/pull/40351)  
**description**:  
Added support for resource attributes. The stat sink will use the resource attributes configured for the OpenTelemetry tracer via [resource_detectors](/docs/envoy/latest/api-v3/config/trace/v3/opentelemetry.proto#envoy-v3-api-field-config-trace-v3-opentelemetryconfig-resource-detectors).   
 
---

**category**   : new_features  
**area**       : otlp_stat_sink  
**summary**    : otel: support custom metric conversions in OTLP statSink (#40854)  
**commit**     : [b56bbc5fd3ac4471f9558f13c84233f278dbda52](https://github.com/envoyproxy/envoy/commit/b56bbc5fd3ac4471f9558f13c84233f278dbda52)  
**pr**         : [40854](https://github.com/envoyproxy/envoy/pull/40854)  
**description**:  
Added support for [custom_metric_conversions](/docs/envoy/latest/api-v3/extensions/stat_sinks/open_telemetry/v3/open_telemetry.proto#envoy-v3-api-field-extensions-stat-sinks-open-telemetry-v3-sinkconfig-custom-metric-conversions). This allows renaming stats, adding static labels, and aggregating multiple stats into generated metrics.   
 
---

**category**   : new_features  
**area**       : lua  
**summary**    : lua: add virtualHost() and virtualHost():metadata() APIs to Lua filter (#40092)  
**commit**     : [bba98c94c729c6af96e397c0af8c3903cf1a1247](https://github.com/envoyproxy/envoy/commit/bba98c94c729c6af96e397c0af8c3903cf1a1247)  
**pr**         : [40092](https://github.com/envoyproxy/envoy/pull/40092)  
**description**:  
Added ``virtualHost()`` to the Stream handle API, allowing Lua scripts to retrieve virtual host information. So far, the only method implemented is ``metadata()``, allowing Lua scripts to access virtual host metadata scoped to the specific filter name. See [Virtual]() for more details.   
 
---

**category**   : new_features  
**area**       : ext_authz  
**summary**    : Reapply "ext_authz: add grpc_service field on the per-route filter" (#40843)  
**commit**     : [c14c2bbebd92e9ff89fb36bc204c2caa43ba7c13](https://github.com/envoyproxy/envoy/commit/c14c2bbebd92e9ff89fb36bc204c2caa43ba7c13)  
**pr**         : [40843](https://github.com/envoyproxy/envoy/pull/40843)  
**description**:  
Added support for per-route gRPC service override in the ``ext_authz`` HTTP filter. This allows different routes to use different external authorization backends by configuring a [grpc_service](/docs/envoy/latest/api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto#envoy-v3-api-field-extensions-filters-http-ext-authz-v3-checksettings-grpc-service) in the per-route ``check_settings``. Routes without this configuration continue to use the default authorization service.   
 
---

**category**   : new_features  
**area**       : ext_authz  
**summary**    : add max_denied_response_body_bytes to http ext_authz (#41253)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**summary**    : ext_authz: add retry policy support for HTTP service (#41345)  
**commit**     : [ee27890793bd38f8216f3f9219325f70b4dfd6db](https://github.com/envoyproxy/envoy/commit/ee27890793bd38f8216f3f9219325f70b4dfd6db) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9) [2f28bc2c5fbdf3064f2e4dbc18d46fb6952366e2](https://github.com/envoyproxy/envoy/commit/2f28bc2c5fbdf3064f2e4dbc18d46fb6952366e2)  
**pr**         : [41253](https://github.com/envoyproxy/envoy/pull/41253) [41491](https://github.com/envoyproxy/envoy/pull/41491) [41345](https://github.com/envoyproxy/envoy/pull/41345)  
**description**:  
Added support for retry policy in the ext_authz HTTP filter. The filter now supports [retry_policy](/docs/envoy/latest/api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto#envoy-v3-api-field-extensions-filters-http-ext-authz-v3-httpservice-retry-policy) configuration for HTTP authorization servers. When configured, failed requests to the authorization server will be automatically retried according to the specified policy.   
 
---

**category**   : new_features  
**area**       : ext_authz  
**summary**    : ext_authz: add retry policy support for HTTP service (#41345)  
**summary**    : add max_denied_response_body_bytes to http ext_authz (#41253)  
**summary**    : changelogs: Pre-release cleanups (#41491)  
**commit**     : [2f28bc2c5fbdf3064f2e4dbc18d46fb6952366e2](https://github.com/envoyproxy/envoy/commit/2f28bc2c5fbdf3064f2e4dbc18d46fb6952366e2) [ee27890793bd38f8216f3f9219325f70b4dfd6db](https://github.com/envoyproxy/envoy/commit/ee27890793bd38f8216f3f9219325f70b4dfd6db) [a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9](https://github.com/envoyproxy/envoy/commit/a9dc15339e2fcb8328c06ce2c0d535cd8fc018a9)  
**pr**         : [41345](https://github.com/envoyproxy/envoy/pull/41345) [41253](https://github.com/envoyproxy/envoy/pull/41253) [41491](https://github.com/envoyproxy/envoy/pull/41491)  
**description**:  
Added [max_denied_response_body_bytes](/docs/envoy/latest/api-v3/extensions/filters/http/ext_authz/v3/ext_authz.proto#envoy-v3-api-field-extensions-filters-http-ext-authz-v3-extauthz-max-denied-response-body-bytes) to the ext_authz HTTP filter. This allows configuring the maximum size of the response body returned to the downstream client when a request is denied by the external authorization service. If the authorization server returns a response body larger than this limit, it will be truncated.   
 
---

**category**   : new_features  
**area**       : ext_authz  
**summary**    : ext_authz: add send_tls_alert_on_denial option on Network ExtAuthZ filter (#41473)  
**commit**     : [6ab1e7afbfda48911e187c9d653a46b8bca98166](https://github.com/envoyproxy/envoy/commit/6ab1e7afbfda48911e187c9d653a46b8bca98166)  
**pr**         : [41473](https://github.com/envoyproxy/envoy/pull/41473)  
**description**:  
Added [send_tls_alert_on_denial](/docs/envoy/latest/api-v3/extensions/filters/network/ext_authz/v3/ext_authz.proto#envoy-v3-api-field-extensions-filters-network-ext-authz-v3-extauthz-send-tls-alert-on-denial) to the network ``ext_authz`` filter. When enabled, the filter sends a TLS ``access_denied(49)`` alert before closing the connection when authorization is denied.   
 
---

**category**   : new_features  
**area**       : ext_proc  
**summary**    : ext_proc: add status_on_error option to control the status code returned (#41124)  
**commit**     : [14fac8851792199a77ffd26d4ce270c0a70a0eef](https://github.com/envoyproxy/envoy/commit/14fac8851792199a77ffd26d4ce270c0a70a0eef)  
**pr**         : [41124](https://github.com/envoyproxy/envoy/pull/41124)  
**description**:  
Added [status_on_error](/docs/envoy/latest/api-v3/extensions/filters/http/ext_proc/v3/ext_proc.proto#envoy-v3-api-field-extensions-filters-http-ext-proc-v3-externalprocessor-status-on-error) to the ``ext_proc`` HTTP filter. This allows configuring the HTTP status code returned to the downstream client when communication with the external processor fails (e.g., gRPC error). Previously, these cases returned a fixed ``500``.   
 
---

**category**   : new_features  
**area**       : ext_proc  
**summary**    : [ext_proc] Introduce an extensible ProcessingRequestModifier interface (#41081)  
**commit**     : [0440ea1a38bbb8932732428010708d29f39d43b7](https://github.com/envoyproxy/envoy/commit/0440ea1a38bbb8932732428010708d29f39d43b7)  
**pr**         : [41081](https://github.com/envoyproxy/envoy/pull/41081)  
**description**:  
Introduced a new [ProcessingRequestModifier](/docs/envoy/latest/api-v3/extensions/filters/http/ext_proc/v3/ext_proc.proto#envoy-v3-api-field-extensions-filters-http-ext-proc-v3-externalprocessor-processing-request-modifier) config and corresponding interface to enable modifying the ``ProcessingRequest`` before it is sent on the wire. Sample use cases include modifying attribute and metadata keys to abstract away filter details. If the config is not set, then there is no behavior change. Supports per-route overrides.   
 
---

**category**   : new_features  
**area**       : tracing  
**summary**    : tracing: add W3C trace header fallback support to Zipkin tracer (#40525)  
**commit**     : [d4a94e75908cd65d159101ebf3fa9e106be62491](https://github.com/envoyproxy/envoy/commit/d4a94e75908cd65d159101ebf3fa9e106be62491)  
**pr**         : [40525](https://github.com/envoyproxy/envoy/pull/40525)  
**description**:  
Added [trace_context_option](/docs/envoy/latest/api-v3/config/trace/v3/zipkin.proto#envoy-v3-api-field-config-trace-v3-zipkinconfig-trace-context-option) enum in the Zipkin tracer config. When set to ``USE_B3_WITH_W3C_PROPAGATION``, the tracer will: extract trace information from W3C trace headers when B3 headers are not present (downstream), and inject both B3 and W3C trace headers for upstream requests to maximize compatibility. The default value ``USE_B3`` maintains backward compatibility with B3-only behavior.   
 
---

**category**   : new_features  
**area**       : tracing  
**summary**    : zipkin: add custom headers support for collector requests (#40863)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [f2c994b5d5eb4cdfcc573b120653e19528ee8f12](https://github.com/envoyproxy/envoy/commit/f2c994b5d5eb4cdfcc573b120653e19528ee8f12) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40863](https://github.com/envoyproxy/envoy/pull/40863) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Enhanced Zipkin tracer with advanced collector configuration via [collector_service](/docs/envoy/latest/api-v3/config/trace/v3/zipkin.proto#envoy-v3-api-field-config-trace-v3-zipkinconfig-collector-service) using ``HttpService``. New features include: #. **Custom HTTP Headers**: Add headers to collector requests for custom metadata, service identification, and collector-specific routing. #. **Full URI Parsing**: The ``uri`` field now supports both path-only (``/api/v2/spans``) and full URI formats (``https://zipkin-collector.example.com/api/v2/spans``). When using full URIs, Envoy automatically extracts hostname and path components - hostname sets the HTTP ``Host`` header, and path sets the request path. Path-only URIs fall back to using the cluster name as the hostname. When configured, ``collector_service`` takes precedence over legacy configuration fields (``collector_cluster``, ``collector_endpoint``, ``collector_hostname``), which will be deprecated in a future release. Legacy configuration does not support custom headers or URI parsing.   
 
---

**category**   : new_features  
**area**       : composite  
**summary**    : composite: allow filters to be added on encode path (#40800)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [ee9d3b13f0e73930236b9371554e3f3ac3fcf7c4](https://github.com/envoyproxy/envoy/commit/ee9d3b13f0e73930236b9371554e3f3ac3fcf7c4) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40800](https://github.com/envoyproxy/envoy/pull/40800) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Allow the composite filter to be configured to insert a filter into the filter chain outside of the decode headers lifecycle phase.   
 
---

**category**   : new_features  
**area**       : rbac  
**summary**    : rbac: use LC Trie for IP range matching performance optimization (#40493)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [975159dc1ac6cba71ac47b27cd4d2a57e667de72](https://github.com/envoyproxy/envoy/commit/975159dc1ac6cba71ac47b27cd4d2a57e667de72) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40493](https://github.com/envoyproxy/envoy/pull/40493) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Switched the IP matcher to use LC-Trie for performance improvements.   
 
---

**category**   : new_features  
**area**       : tls_inspector  
**summary**    : Add dynamic metadata for TLS inspector filter errors (#40529)  
**commit**     : [baca79165ad5276b7e8657624a74b79d0f31e71d](https://github.com/envoyproxy/envoy/commit/baca79165ad5276b7e8657624a74b79d0f31e71d)  
**pr**         : [40529](https://github.com/envoyproxy/envoy/pull/40529)  
**description**:  
Added dynamic metadata when failing to parse the ``ClientHello``.   
 
---

**category**   : new_features  
**area**       : matching  
**summary**    : matcher: Add NetworkNamespaceInput matcher for namespace-based filter chain selection (#41145)  
**commit**     : [8b38e06091e51e42257832a0ab9bd41ba0ccb716](https://github.com/envoyproxy/envoy/commit/8b38e06091e51e42257832a0ab9bd41ba0ccb716)  
**pr**         : [41145](https://github.com/envoyproxy/envoy/pull/41145)  
**description**:  
Added [NetworkNamespaceInput](/docs/envoy/latest/api-v3/extensions/matching/common_inputs/network/v3/network_inputs.proto#envoy-v3-api-msg-extensions-matching-common-inputs-network-v3-networknamespaceinput) to the matcher framework. This input returns the listener address's ``network_namespace_filepath`` for use with [filter_chain_matcher](/docs/envoy/latest/api-v3/config/listener/v3/listener.proto#envoy-v3-api-field-config-listener-v3-listener-filter-chain-matcher), enabling filter chain selection based on the Linux network namespace of the bound socket. On non-Linux platforms, the input returns an empty value and connections use the default filter chain.   
 
---

**category**   : new_features  
**area**       : rbac  
**summary**    : rbac: enable use of NetworkNamespaceInput in network RBAC filter (#41199)  
**commit**     : [39a4dc9ddb52089e89b7e9b87537acde141345b6](https://github.com/envoyproxy/envoy/commit/39a4dc9ddb52089e89b7e9b87537acde141345b6)  
**pr**         : [41199](https://github.com/envoyproxy/envoy/pull/41199)  
**description**:  
Enabled use of [NetworkNamespaceInput](/docs/envoy/latest/api-v3/extensions/matching/common_inputs/network/v3/network_inputs.proto#envoy-v3-api-msg-extensions-matching-common-inputs-network-v3-networknamespaceinput) in the network RBAC filter's matcher. This allows RBAC policies to evaluate the Linux network namespace of the listening socket via the generic matcher API.   
 
---

**category**   : new_features  
**area**       : lua  
**summary**    : lua: extend StreamHandle API with route() to access matched route metadata (#40531)  
**commit**     : [1b389f593fd9db4e9d998f208b1a284b2145e714](https://github.com/envoyproxy/envoy/commit/1b389f593fd9db4e9d998f208b1a284b2145e714)  
**pr**         : [40531](https://github.com/envoyproxy/envoy/pull/40531)  
**description**:  
Added ``route()`` to the Stream handle API, allowing Lua scripts to retrieve route information. So far, the only method implemented is ``metadata()``, allowing Lua scripts to access route metadata scoped to the specific filter name. See [Route]() for more details.   
 
---

**category**   : new_features  
**area**       : cel  
**summary**    : cel: add support for typed Value format output (#40448)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**commit**     : [fc3db7c435874f0e8acb3db1c27b0299e5bf2763](https://github.com/envoyproxy/envoy/commit/fc3db7c435874f0e8acb3db1c27b0299e5bf2763) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441)  
**pr**         : [40448](https://github.com/envoyproxy/envoy/pull/40448) [40993](https://github.com/envoyproxy/envoy/pull/40993)  
**description**:  
Added a new ``%TYPED_CEL%`` formatter command that, unlike ``%CEL%``, can output non-string values (number, boolean, null, etc.) when used in formatting contexts that accept non-string values, such as [json_format](/docs/envoy/latest/api-v3/config/core/v3/substitution_format_string.proto#envoy-v3-api-field-config-core-v3-substitutionformatstring-json-format). The new command is introduced so as to not break compatibility with the existing command's behavior.   
 
---

**category**   : new_features  
**area**       : rbac  
**summary**    : rbac: enable use of NetworkNamespaceInput in HTTP RBAC filter (#41200)  
**commit**     : [2e77a6834391c9ea43d33d33f0edf4194ebce216](https://github.com/envoyproxy/envoy/commit/2e77a6834391c9ea43d33d33f0edf4194ebce216)  
**pr**         : [41200](https://github.com/envoyproxy/envoy/pull/41200)  
**description**:  
Enabled use of [NetworkNamespaceInput](/docs/envoy/latest/api-v3/extensions/matching/common_inputs/network/v3/network_inputs.proto#envoy-v3-api-msg-extensions-matching-common-inputs-network-v3-networknamespaceinput) in the network and HTTP RBAC filters' matchers. This allows RBAC policies to evaluate the Linux network namespace of the listening socket via the generic matcher API.   
 
---

**category**   : new_features  
**area**       : dynamic_modules  
**summary**    : dynamic_modules: adds logging ABI (#40496)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [2512b1d442562b7f91a898e230a33161192286e5](https://github.com/envoyproxy/envoy/commit/2512b1d442562b7f91a898e230a33161192286e5) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40496](https://github.com/envoyproxy/envoy/pull/40496) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Added a new Logging ABI that allows modules to emit logs in the standard Envoy logging stream under ``dynamic_modules`` ID. In the Rust SDK, they are available as ``envoy_log_info``, etc.   
 
---

**category**   : new_features  
**area**       : tcp_proxy  
**summary**    : tcp_proxy: add support for populating TLVs with dynamic metadata (#41294)  
**commit**     : [e43d5ed0206b2cf35c6575e58388b34464fc10a7](https://github.com/envoyproxy/envoy/commit/e43d5ed0206b2cf35c6575e58388b34464fc10a7)  
**pr**         : [41294](https://github.com/envoyproxy/envoy/pull/41294)  
**description**:  
Added support for dynamic TLV values in PROXY protocol using [format_string](/docs/envoy/latest/api-v3/config/core/v3/proxy_protocol.proto#envoy-v3-api-field-config-core-v3-tlventry-format-string) field. This allows TLV values to be populated dynamically from stream information using format strings (e.g., ``%DYNAMIC_METADATA(...)%``, ``%FILTER_STATE(...)%``, ``%DOWNSTREAM_REMOTE_ADDRESS%``).   
 
---

**category**   : new_features  
**area**       : http  
**summary**    : HTTP: Add request per connection tracking and metrics (#40266)  
**commit**     : [f712ba46d00cb6df0da336a93510330a2ae4f558](https://github.com/envoyproxy/envoy/commit/f712ba46d00cb6df0da336a93510330a2ae4f558)  
**pr**         : [40266](https://github.com/envoyproxy/envoy/pull/40266)  
**description**:  
Added ``upstream_rq_per_cx`` histogram to track requests per connection for monitoring connection reuse efficiency.   
 
---

**category**   : new_features  
**area**       : http  
**summary**    : add override knob for stream flush timeout (#40811)  
**commit**     : [d552b66f5d70ddd9e13c68c40f70729a45fb24e0](https://github.com/envoyproxy/envoy/commit/d552b66f5d70ddd9e13c68c40f70729a45fb24e0)  
**pr**         : [40811](https://github.com/envoyproxy/envoy/pull/40811)  
**description**:  
Added [stream_flush_timeout](/docs/envoy/latest/api-v3/extensions/filters/network/http_connection_manager/v3/http_connection_manager.proto#envoy-v3-api-field-extensions-filters-network-http-connection-manager-v3-httpconnectionmanager-stream-flush-timeout) to allow for configuring a stream flush timeout independently from the stream idle timeout.   
 
---

**category**   : new_features  
**area**       : http  
**summary**    : header mutation: support remove on match (#41076)  
**commit**     : [ab743ae22167323a9fa164905f7a2ff2b94057cd](https://github.com/envoyproxy/envoy/commit/ab743ae22167323a9fa164905f7a2ff2b94057cd)  
**pr**         : [41076](https://github.com/envoyproxy/envoy/pull/41076)  
**description**:  
Added support for header removal based on header key matching. The new [remove_on_match](/docs/envoy/latest/api-v3/config/common/mutation_rules/v3/mutation_rules.proto#envoy-v3-api-field-config-common-mutation-rules-v3-headermutation-remove-on-match) allows removing headers that match a specified key pattern. This enables more flexible and dynamic header manipulation based on header names.   
 
---

**category**   : new_features  
**area**       : geoip  
**summary**    : maxmind geoip provider: add gauge to track database creation timestamp (#40809)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#40993)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [d7b2be80f72abea5b4fb824fa48eead9172f92bc](https://github.com/envoyproxy/envoy/commit/d7b2be80f72abea5b4fb824fa48eead9172f92bc) [7bbfd62be49228767f90b38512b547263a296441](https://github.com/envoyproxy/envoy/commit/7bbfd62be49228767f90b38512b547263a296441) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [40809](https://github.com/envoyproxy/envoy/pull/40809) [40993](https://github.com/envoyproxy/envoy/pull/40993) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Added a new metric ``db_build_epoch`` to track the build timestamp of the MaxMind geolocation database files. This can be used to monitor the freshness of the databases currently in use by the filter. See `MaxMind-DB build_epoch <https://maxmind.github.io/MaxMind-DB/#build_epoch>`_ for more details.   
 
---

**category**   : new_features  
**area**       : overload management  
**summary**    : Add scaled timer HttpDownstreamStreamFlush (#40984)  
**commit**     : [196cb2991dfd40b47fdf890a51f9d8db4db1aeb6](https://github.com/envoyproxy/envoy/commit/196cb2991dfd40b47fdf890a51f9d8db4db1aeb6)  
**pr**         : [40984](https://github.com/envoyproxy/envoy/pull/40984)  
**description**:  
Added a new scaled timer type ``HttpDownstreamStreamFlush`` to the overload manager. This allows Envoy to scale the periodic timer for flushing downstream responses based on resource pressure. The new timer can be configured via the [ScaleTimersOverloadActionConfig](/docs/envoy/latest/api-v3/config/overload/v3/overload.proto#envoy-v3-api-msg-config-overload-v3-scaletimersoverloadactionconfig).   
 
---

**category**   : new_features  
**area**       : thrift  
**summary**    : http filter thrift_to_metadata allows field_selector to parse thrift paylaod (#41023)  
**commit**     : [ef5577b5d76e37ef15821a659038fb40726a9fba](https://github.com/envoyproxy/envoy/commit/ef5577b5d76e37ef15821a659038fb40726a9fba)  
**pr**         : [41023](https://github.com/envoyproxy/envoy/pull/41023)  
**description**:  
Support [field_selector](/docs/envoy/latest/api-v3/extensions/filters/http/thrift_to_metadata/v3/thrift_to_metadata.proto#envoy-v3-api-field-extensions-filters-http-thrift-to-metadata-v3-rule-field-selector) to extract specified fields in thrift body for thrift_to_metadata http filter.   
 
---

**category**   : new_features  
**area**       : dynamic_modules  
**summary**    : dynamic modules: support metrics with labels by defining metric vector counterparts (#41003)  
**commit**     : [8b5588380cdccab7b7a30e06d0b2b725d0ad11e3](https://github.com/envoyproxy/envoy/commit/8b5588380cdccab7b7a30e06d0b2b725d0ad11e3)  
**pr**         : [41003](https://github.com/envoyproxy/envoy/pull/41003)  
**description**:  
Added support for counters, gauges, histograms, and their vector variants to the dynamic modules API.   
 
---

**category**   : new_features  
**area**       : dns_resolver  
**summary**    : dns_resolver: add max_udp_channel_duration to allow periodic refresh of the UDP channel (#41085)  
**summary**    : changelog: fix typos in the current changelogs and clean them up (#41161)  
**commit**     : [05f2b84936f11a2e2863f25f419fb88af3256888](https://github.com/envoyproxy/envoy/commit/05f2b84936f11a2e2863f25f419fb88af3256888) [1a26ba39c1165508ef0e82325aed43a86d7bf04e](https://github.com/envoyproxy/envoy/commit/1a26ba39c1165508ef0e82325aed43a86d7bf04e)  
**pr**         : [41085](https://github.com/envoyproxy/envoy/pull/41085) [41161](https://github.com/envoyproxy/envoy/pull/41161)  
**description**:  
Added [max_udp_channel_duration](/docs/envoy/latest/api-v3/extensions/network/dns_resolver/cares/v3/cares_dns_resolver.proto#envoy-v3-api-field-extensions-network-dns-resolver-cares-v3-caresdnsresolverconfig-max-udp-channel-duration) configuration field to the c-ares DNS resolver. This allows periodic refresh of the UDP channel to help avoid stale socket states and provide better load distribution across UDP ports.   
 
---

**category**   : new_features  
**area**       : tcp_proxy  
**summary**    : tcp_proxy: Add max_downstream_connection_duration_jitter_percentage (#40999)  
**commit**     : [d2237957032e11f7466ad2307167cdbe5d4826e8](https://github.com/envoyproxy/envoy/commit/d2237957032e11f7466ad2307167cdbe5d4826e8)  
**pr**         : [40999](https://github.com/envoyproxy/envoy/pull/40999)  
**description**:  
Added ``max_downstream_connection_duration_jitter_percentage`` to allow adding a jitter to the max downstream connection duration. This can be used to avoid thundering herd problems with many clients being disconnected and possibly reconnecting at the same time.   
 
---

**category**   : new_features  
**area**       : http  
**summary**    : http: implement setUpstreamOverrideHost for AsyncClient (#41272)  
**commit**     : [3a3cd2e38258564e91ec4a1ddbc6f4e7e1937829](https://github.com/envoyproxy/envoy/commit/3a3cd2e38258564e91ec4a1ddbc6f4e7e1937829)  
**pr**         : [41272](https://github.com/envoyproxy/envoy/pull/41272)  
**description**:  
Added ``setUpstreamOverrideHost`` method to AsyncClient StreamOptions to enable direct host routing that bypasses load balancer selection.   
 
---

**category**   : new_features  
**area**       : router  
**summary**    : router: Support request header addition/removal and host header rewrite for mirroring (#41178)  
**commit**     : [b9a43495d6831fbb6e02696d28a0249a12d06cd2](https://github.com/envoyproxy/envoy/commit/b9a43495d6831fbb6e02696d28a0249a12d06cd2)  
**pr**         : [41178](https://github.com/envoyproxy/envoy/pull/41178)  
**description**:  
Added support for [request_headers_mutations](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-routeaction-requestmirrorpolicy-request-headers-mutations) to enable header manipulation for mirror requests. Added support for [host_rewrite_literal](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-routeaction-requestmirrorpolicy-host-rewrite-literal) in [request_mirror_policies](/docs/envoy/latest/api-v3/config/route/v3/route_components.proto#envoy-v3-api-field-config-route-v3-routeaction-request-mirror-policies) to enable host header rewrite for mirror requests.   
 
---

**category**   : new_features  
**area**       : outlier detection  
**summary**    : upstream: outlier detection for non 5xx codes (#39947)  
**commit**     : [2a5978a7d239358c7e8675ded3ae7a4ca8e63379](https://github.com/envoyproxy/envoy/commit/2a5978a7d239358c7e8675ded3ae7a4ca8e63379)  
**pr**         : [39947](https://github.com/envoyproxy/envoy/pull/39947)  
**description**:  
Added [outlier_detection](/docs/envoy/latest/api-v3/extensions/upstreams/http/v3/http_protocol_options.proto#envoy-v3-api-field-extensions-upstreams-http-v3-httpprotocoloptions-outlier-detection) to cluster's http protocol options to allow defining via an http matcher whether a response should be treated as error or as success by outlier detection.   
 
---

**category**   : new_features  
**area**       : reverse_tunnel  
**summary**    : docs: add release note for reverse tunnels (#41382)  
**commit**     : [eeb18f7812ca27870743b63308e6f1f13284df3e](https://github.com/envoyproxy/envoy/commit/eeb18f7812ca27870743b63308e6f1f13284df3e)  
**pr**         : [41382](https://github.com/envoyproxy/envoy/pull/41382)  
**description**:  
Added support for reverse tunnels that enable establishing persistent connections from downstream Envoy instances to upstream Envoy instances without requiring the upstream to be directly reachable. This feature is particularly useful when downstream instances are behind NATs, firewalls, or in private networks. The feature is experimental and under active development, but is ready for experimental use. See [reverse]() for details.   
 
---

**category**   : new_features  
**area**       : compressor  
**summary**    : compressor: adds compression status header to compressor_filter (#41079)  
**summary**    : changelog: addressing some nits in the change logs before release  (#41497)  
**commit**     : [59fa271e0befc483e91b9e55164803d2b2ed060a](https://github.com/envoyproxy/envoy/commit/59fa271e0befc483e91b9e55164803d2b2ed060a) [6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9](https://github.com/envoyproxy/envoy/commit/6e2932c76f9a5517e0bd8669f1b646d2c4ae77b9)  
**pr**         : [41079](https://github.com/envoyproxy/envoy/pull/41079) [41497](https://github.com/envoyproxy/envoy/pull/41497)  
**description**:  
Added [status_header_enabled](/docs/envoy/latest/api-v3/extensions/filters/http/compressor/v3/compressor.proto#envoy-v3-api-field-extensions-filters-http-compressor-v3-compressor-responsedirectionconfig-status-header-enabled) to the [compressor](). When enabled, it adds a new response header ``x-envoy-compression-status`` to the [compressor](). This header provides information on whether the response was compressed and, if not, the reason why compression was skipped. Enabling this feature updates the order of conditions checked within the [compressor]() to emit the most appropriate status reason.   
 
---

